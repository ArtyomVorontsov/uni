Task Description:

You are required to assume the role of a Database Developer for a financial services company that processes customer loan applications. Your responsibility is to design and implement one comprehensive PL/SQL package that manages the Loan Application Lifecycle, including loan submission, eligibility validation, approval, disbursement, and repayment tracking.

The package must include all logic needed to perform these operations, maintain consistency across multiple tables, and log business events in an audit table.

Your solution will consist of three SQL scripts:

    A DDL file defining all database objects.
    A DML file inserting realistic sample data.
    A PL/SQL package script containing both the package specification and body, along with demonstration blocks.

The final solution must be runnable in Oracle Live SQL and submitted as three separate files.

Requirements:

Your PL/SQL package solution must include the following components:

1. Database Schema (DDL Script)

    Create tables representing customers, loan applications, loan payments, and an audit log.
    Include attributes such as loan amount, interest rate, repayment period, loan status, and approval date.
    Define appropriate primary and foreign keys, constraints, and indexes.
    Use clear and meaningful column names and add brief comments describing each table’s purpose.

2. Sample Data (DML Script)

    Insert at least five customers with varying credit profiles (e.g., good, average, poor).
    Insert multiple loan applications in different states (e.g., submitted, approved, rejected, repaid).
    Include realistic data that allows you to demonstrate both successful and failed loan applications.
    Insert a few payment records to represent loan repayments for approved loans.

3. PL/SQL Package (Specification and Body Script)

    Create one package (for example, pkg_loan_lifecycle) that includes all logic required to manage the loan process.
    The package must include:
        At least three procedures that perform operations such as submitting a loan, approving a loan, disbursing funds, or recording payments.
        At least two functions that perform calculations or validations (e.g., computing monthly payment amount or checking loan eligibility).
        At least one package-level variable or constant (for example, a default interest rate, approval threshold, or package version number).
        Custom exceptions with meaningful error messages (e.g., insufficient credit score, loan amount exceeds limit).
        Logging mechanism that writes to the audit table whenever a key business event occurs (e.g., loan approved, rejected, payment received).
    Each procedure and function must have appropriate input and output parameters.
    Include exception handling and ensure no commits or rollbacks occur inside the package.
    Add comments in both the package specification and body describing purpose, parameters, and behavior.

4. Demonstration Blocks

    Provide multiple anonymous PL/SQL blocks that show how to use the package.
    Demonstrate the following scenarios:
        Submitting a new loan application for a valid customer and successfully approving it.
        Attempting to submit or approve a loan for an ineligible customer (e.g., low credit score or invalid amount).
        Disbursing funds and recording repayment for an approved loan.
        Viewing audit logs generated by the package.
    Each block should print a clear summary of results using DBMS_OUTPUT.

Submission Guidelines:

    Prepare and submit the following three files:
        loan_pkg_ddl.sql — contains only table creation statements.
        loan_pkg_dml.sql — contains only data insertion statements.
        loan_pkg_package.sql — contains both the package specification and body, followed by demonstration blocks.
    Each file must start with a header that includes your name, date, and a short description.
    Scripts must be executable in Oracle Live SQL in the order DDL → DML → Package.
    Each script must be cleanly formatted, compile successfully, and include short inline comments explaining design choices and logic.

